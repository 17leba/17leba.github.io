!function(){var a=0,b=[],c={checkType:function(a){return this.isArray(a)||this.isObject(a)?!0:!1},isArray:function(a){return Array.isArray(a)||"[object Array]"===toString.call(a)},isObject:function(a){return"[object Object]"===toString.call(a)}},d={progress:0,init:function(d,e){if(!c.checkType(d))return alert("载入资源格式为数组或者对象！"),!1;if(c.isArray(d)){for(var f=d.length,g=0;f>g;g++)a+=d[g].length;b=d}if(c.isObject(d))for(var g in d)a+=d[g].length,b.push(d[g]);this.loadMain(b,e)},loadMain:function(b,c){function d(){var b=document.createElement("audio");return b.src=h[k],b.play?void b.addEventListener("canplay",n,!1):(k=h.length,f.progress=(j+k)/a,f.showProgressBar(f.progress,h[k-1]),void e())}function e(){var b=new XMLHttpRequest||new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(4===b.readyState)if(200===b.status)f.dealXmlHttp(b),l++,l<i.length&&e(),f.progress=(j+k+l)/a,f.showProgressBar(f.progress,i[l-1]),l===i.length&&c();else{if(m++,3===m)return!1;e()}},b.open("GET",i[l],!0),b.setRequestHeader("Content-Type","application/json"),b.send(null)}var f=this,g=b[0],h=b[1],i=b[2],j=0,k=0,l=0,m=0,n=function(){Config.mediaSource.push(this),k++,k<h.length&&d(),f.progress=(j+k)/a,f.showProgressBar(f.progress,h[k-1]),this.removeEventListener("canplay",n,!1),k===h.length&&e()},o=function(){var b=new Image;b.src=g[j],b.onload=function(){b.complete===!0&&(Config.imgSource.push(b),j++,j<g.length&&o(),f.progress=j/a,f.showProgressBar(f.progress,g[j-1]),j===g.length&&d())},b.error=function(){j++,o(),f.progress=parseFloat(j/a).toFixed(2),f.showProgressBar(f.progress,g[j-1])}};o()},dealXmlHttp:function(a){var b=JSON.parse(a.responseText),c=b.meta.image.replace(/(.png|.jpeg|.jpg|.gif)$/i,"");Config.jsonObj[c]=b.frames},showProgressBar:function(a){var a=(Config.progressBarW,Config.progressBarH,Config.progressRadius,canvas.width,canvas.height,parseInt(100*a));document.getElementById("load-precent").style.width=500*a/100+"px",document.getElementById("load-precent-nums").innerHTML=a+"%"},showPrecentNums:function(a){document.getElementById("load-precent-nums").innerHTML=a+"%"}};window.loadSources=d}();